p <- ggplot(df, aes(x=poisson1, y = ..density..)) +
geom_histogram(color="darkblue", fill="lightblue", binwidth = 0.5, bins = 15) + labs(x = '', y = '')# +
#scale_y_discrete(breaks = waiver())
p
p <- ggplot(df, aes(x=binom2, y = ..density..)) +
geom_histogram(color="orange", fill="orange", binwidth = 0.5, bins = 15, alpha = .5) + labs(x = '', y = '')# +
#scale_y_discrete(breaks = waiver())
p
p1 <- ggplot(data = data.frame(x = c(6, 12)), aes(x)) +
stat_function(fun = dnorm, n = 101,
args = list(mean = 9, sd = 0.5), color="purple") +
labs(x = '', y = '') +
scale_y_continuous(breaks = NULL)
p1
p1 <- ggplot(data = data.frame(x = c(6, 12)), aes(x)) +
stat_function(fun = dnorm, n = 101,
args = list(mean = 9, sd = 0.5), color="pink") +
labs(x = '', y = '') +
scale_y_continuous(breaks = NULL)
p1
p1 <- ggplot(data = data.frame(x = c(6, 12)), aes(x)) +
stat_function(fun = dnorm, n = 101,
args = list(mean = 9, sd = 0.5), color="darkpink") +
labs(x = '', y = '') +
scale_y_continuous(breaks = NULL)
p1
p1 <- ggplot(data = data.frame(x = c(6, 12)), aes(x)) +
stat_function(fun = dnorm, n = 101,
args = list(mean = 9, sd = 0.5), color="gray") +
labs(x = '', y = '') +
scale_y_continuous(breaks = NULL)
p1
p1 <- ggplot(data = data.frame(x = c(6, 12)), aes(x)) +
stat_function(fun = dnorm, n = 101,
args = list(mean = 9, sd = 0.5), color="darkgray") +
labs(x = '', y = '') +
scale_y_continuous(breaks = NULL)
p1
p1 <- ggplot(data = data.frame(x = c(6, 12)), aes(x)) +
stat_function(fun = dnorm, n = 101,
args = list(mean = 9, sd = 0.5), color="orchid") +
labs(x = '', y = '') +
scale_y_continuous(breaks = NULL)
p1
p1 <- ggplot(data = data.frame(x = c(-20, 20)), aes(x)) +
stat_function(fun = dnorm, n = 1000,
args = list(mean = 0, sd = 7), color="purple") +
labs(x = '', y = '') +
scale_y_continuous(breaks = NULL) +
stat_function(fun = dnorm, n = 1000,
args = list(mean = 5, sd = 2), color="red") +
labs(x = '', y = '') +
stat_function(fun = dnorm, n = 1000,
args = list(mean = 0, sd = 1.5), color="black") +
labs(x = '', y = '') +
stat_function(fun = dnorm, n = 1000,
args = list(mean = -3, sd = 5), color="blue") +
labs(x = '', y = '')
p1
setwd("~/Documents/Packages/mixOmics/Bioconductor/Vignette/Bookdown")
# Let's work on the details
data = read.csv('Countries in South Saharan Africa.csv')
dim(data)
# remove south sudan
data = data[-c(48),]
summary(data$World.Bank.income.group.2001)
boxplot(data$TB.deaths.per.100.000.2001 ~ droplevels(data$World.Bank.income.group.2001))
library(ggplot2)
# Basic box plot
p <- ggplot(data, aes(x=World.Bank.income.group.2001, y=TB.deaths.per.100.000.2001)) +
geom_boxplot() + labs(title="Boxplot of TB 2001", x = 'WB income group 2001', y = "TB 2001")+
theme_classic() + theme(plot.title = element_text(hjust = 0.5))
p
# Let's work on the details
data = read.csv('Countries in South Saharan Africa.csv')
dim(data)
# remove south sudan
data = data[-c(48),]
summary(data$World.Bank.income.group.2001)
boxplot(data$TB.deaths.per.100.000.2001 ~ droplevels(data$World.Bank.income.group.2001))
setwd("~/Documents/Packages/mixOmics/Bioconductor/Vignette/Bookdown")
setwd("~/Documents/University of Melbourne/Teaching/MOOC/MOOC 3/Week3/Work on the detail wacom")
data = read.csv('Countries in South Saharan Africa.csv')
dim(data)
# remove south sudan
data = data[-c(48),]
summary(data$World.Bank.income.group.2001)
boxplot(data$TB.deaths.per.100.000.2001 ~ droplevels(data$World.Bank.income.group.2001))
p <- ggplot(data, aes(x=World.Bank.income.group.2001, y=TB.deaths.per.100.000.2001)) +
geom_boxplot() + labs(title="Boxplot of TB 2001", x = 'WB income group 2001', y = "TB 2001")+
theme_classic() + theme(plot.title = element_text(hjust = 0.5))
p
# Basic box plot
p <- ggplot(data, aes(x=World.Bank.income.group.2001, y=TB.deaths.per.100.000.2001)) +
geom_boxplot() + labs(title="Boxplot of TB 2001", x = 'WB income group 2001', y = "TB 2001")+
theme_classic() + theme(plot.title = element_text(hjust = 1))
p
# Basic box plot
p <- ggplot(data, aes(x=World.Bank.income.group.2001, y=TB.deaths.per.100.000.2001)) +
geom_boxplot() + labs(title="Boxplot of TB 2001", x = 'WB income group 2001', y = "TB 2001")+
theme_classic() + theme(plot.title = element_text(hjust = 0.5)) + theme_grey(base_size = 18)
p
p <- ggplot(data, aes(x=World.Bank.income.group.2001, y=TB.deaths.per.100.000.2001, fill = World.Bank.income.group.2001)) +
geom_boxplot() + labs(title="Tuberculosis deaths in 2001 in Sub-Saharan countries", x = 'World Bank income group in 2001', y = "Tuberculosis deaths per 100,000 in 2001")+
theme(plot.title = element_text(hjust = 0.5)) + scale_fill_brewer(palette="Dark2") + theme(legend.position="none")
p
p <- ggplot(data, aes(x=World.Bank.income.group.2001, y=TB.deaths.per.100.000.2001, fill = World.Bank.income.group.2001)) +
geom_boxplot() + labs(title="Tuberculosis deaths in 2001 in Sub-Saharan countries", x = 'World Bank income group in 2001', y = "Tuberculosis deaths per 100,000 in 2001")+
theme(plot.title = element_text(hjust = 0.5)) + scale_fill_brewer(palette="Dark2") + theme(legend.position="none") + theme_grey(base_size = 18)
p
# improved
# Basic box plot
p <- ggplot(data, aes(x=World.Bank.income.group.2001, y=TB.deaths.per.100.000.2001, fill = World.Bank.income.group.2001)) +
geom_boxplot() + labs(title="Tuberculosis deaths in 2001 in Sub-Saharan countries", x = 'World Bank income group in 2001', y = "Tuberculosis deaths per 100,000 in 2001")+
theme(plot.title = element_text(hjust = 0.5), legend.position="none") + scale_fill_brewer(palette="Dark2") + theme_grey(base_size = 18)
p
p <- ggplot(data, aes(x=World.Bank.income.group.2001, y=TB.deaths.per.100.000.2001, fill = World.Bank.income.group.2001)) + theme_grey(base_size = 18) +
geom_boxplot() + labs(title="Tuberculosis deaths in 2001 in Sub-Saharan countries", x = 'World Bank income group in 2001', y = "Tuberculosis deaths per 100,000 in 2001")+
theme(plot.title = element_text(hjust = 0.5), legend.position="none") + scale_fill_brewer(palette="Dark2")
p
# ----------
# scatterplot 1
# ----------
p <- ggplot(data, aes(x=HIV.percentage..15.49.years..2001, y=TB.deaths.per.100.000.2001)) +
geom_point() +  theme_classic() + labs(x = 'HIV prevalence in 2001', y = "Tuberculosis deaths per 100,000 in 2001") +
ggtitle('HIV prevalence and tuberculosis deaths in 2001 in Sub-Saharan countries') +
theme(plot.title = element_text(size=12, hjust = 0.5))
p
# ----------
# scatterplot 1
# ----------
p <- ggplot(data, aes(x=HIV.percentage..15.49.years..2001, y=TB.deaths.per.100.000.2001)) +
geom_point() +  theme_classic(base_size = 18) + labs(x = 'HIV prevalence in 2001', y = "Tuberculosis deaths per 100,000 in 2001") +
ggtitle('HIV prevalence and tuberculosis deaths in 2001 in Sub-Saharan countries') +
theme(plot.title = element_text(size=12, hjust = 0.5))
p
# ----------
# scatterplot 1
# ----------
p <- ggplot(data, aes(x=HIV.percentage..15.49.years..2001, y=TB.deaths.per.100.000.2001)) +
geom_point() +  theme_classic(base_size = 18) + labs(x = 'HIV prevalence in 2001', y = "Tuberculosis deaths per 100,000 in 2001") +
ggtitle('HIV prevalence and tuberculosis deaths in 2001 in Sub-Saharan countries') +
theme(plot.title = element_text(size=14, hjust = 0.5))
p
# ----------
# scatterplot 1
# ----------
p <- ggplot(data, aes(x=HIV.percentage..15.49.years..2001, y=TB.deaths.per.100.000.2001)) +
geom_point() +  theme_classic(base_size = 18) + labs(x = 'HIV prevalence in 2001', y = "Tuberculosis deaths per 100,000 in 2001") +
ggtitle('HIV prevalence and tuberculosis deaths in 2001 in Sub-Saharan countries') +
theme(plot.title = element_text(hjust = 0.5))  #size=14,
p
# ----------
# scatterplot 1
# ----------
p <- ggplot(data, aes(x=HIV.percentage..15.49.years..2001, y=TB.deaths.per.100.000.2001)) +
geom_point() +  theme_classic(base_size = 18) + labs(x = 'HIV prevalence in 2001', y = "Tuberculosis deaths per 100,000 in 2001") +
ggtitle('HIV prevalence and tuberculosis deaths in 2001 in Sub-Saharan countries') +
theme(plot.title = element_text(size=14, hjust = 0.5))
p
# ----------
# scatterplot 1
# ----------
p <- ggplot(data, aes(x=HIV.percentage..15.49.years..2001, y=TB.deaths.per.100.000.2001)) +
geom_point() +  theme_classic(base_size = 18) + labs(x = 'HIV prevalence in 2001', y = "Tuberculosis deaths per 100,000 in 2001") +
ggtitle('HIV prevalence and tuberculosis deaths in 2001 in Sub-Saharan countries') +
theme(plot.title = element_text(size=16, hjust = 0.5))
p
# ----------
# scatterplot 1
# ----------
p <- ggplot(data, aes(x=HIV.percentage..15.49.years..2001, y=TB.deaths.per.100.000.2001)) +
geom_point() +  theme_classic(base_size = 16) + labs(x = 'HIV prevalence in 2001', y = "Tuberculosis deaths per 100,000 in 2001") +
ggtitle('HIV prevalence and tuberculosis deaths in 2001 in Sub-Saharan countries') +
theme(plot.title = element_text(size=16, hjust = 0.5))
p
# improved
# Basic box plot
p <- ggplot(data, aes(x=World.Bank.income.group.2001, y=TB.deaths.per.100.000.2001, fill = World.Bank.income.group.2001)) + theme_grey(base_size = 16) +
geom_boxplot() + labs(title="Tuberculosis deaths in 2001 in Sub-Saharan countries", x = 'World Bank income group in 2001', y = "Tuberculosis deaths per 100,000 in 2001")+
theme(plot.title = element_text(hjust = 0.5), legend.position="none") + scale_fill_brewer(palette="Dark2")
p
# improvement
p <- ggplot(data, aes(x=HIV.percentage..15.49.years..2001, y=TB.deaths.per.100.000.2001)) +
geom_point() + labs(x = 'HIV prevalence in 2001', y = "Tuberculosis deaths per 100,000 in 2001") +
ggtitle('HIV prevalence and tuberculosis deaths in 2001 in Sub-Saharan countries') +
theme(plot.title = element_text(size=12, hjust = 0.5)) + scale_y_continuous(breaks = c(seq(0, 450, 50)))
p
# improvement
p <- ggplot(data, aes(x=HIV.percentage..15.49.years..2001, y=TB.deaths.per.100.000.2001)) +
geom_point() + labs(x = 'HIV prevalence in 2001', y = "Tuberculosis deaths per 100,000 in 2001") +
ggtitle('HIV prevalence and tuberculosis deaths in 2001 in Sub-Saharan countries') + theme_grey(base_size = 18) +
theme(plot.title = element_text(size=16, hjust = 0.5)) + scale_y_continuous(breaks = c(seq(0, 450, 50)))
p
# improvement
p <- ggplot(data, aes(x=HIV.percentage..15.49.years..2001, y=TB.deaths.per.100.000.2001)) +
geom_point() + labs(x = 'HIV prevalence in 2001', y = "Tuberculosis deaths per 100,000 in 2001") +
ggtitle('HIV prevalence and tuberculosis deaths in 2001 in Sub-Saharan countries') + theme_grey(base_size = 16) +
theme(plot.title = element_text(size=16, hjust = 0.5)) + scale_y_continuous(breaks = c(seq(0, 450, 50)))
p
# improvement
index.HIV = which(data$HIV.percentage..15.49.years..2001 <10)
name.country = data$Country
name.country[index.HIV] = ''
p <- ggplot(data, aes(x=HIV.percentage..15.49.years..2001, y=TB.deaths.per.100.000.2001)) +
geom_point() + labs(x = 'HIV prevalence in 2001', y = "Tuberculosis deaths per 100,000 in 2001") +
ggtitle('HIV prevalence and tuberculosis deaths in 2001 in Sub-Saharan countries') +
theme(plot.title = element_text(size=12, hjust = 0.5)) + scale_y_continuous(breaks = c(seq(0, 450, 50))) +
geom_text(label=name.country, size= 3, vjust = 1.5, hjust = 1)
p
# improvement
index.HIV = which(data$HIV.percentage..15.49.years..2001 <10)
name.country = data$Country
name.country[index.HIV] = ''
p <- ggplot(data, aes(x=HIV.percentage..15.49.years..2001, y=TB.deaths.per.100.000.2001)) +
geom_point() + labs(x = 'HIV prevalence in 2001', y = "Tuberculosis deaths per 100,000 in 2001") +
ggtitle('HIV prevalence and tuberculosis deaths in 2001 in Sub-Saharan countries') + theme_grey(base_size = 16)+
theme(plot.title = element_text(size=12, hjust = 0.5)) + scale_y_continuous(breaks = c(seq(0, 450, 50))) +
geom_text(label=name.country, size= 3, vjust = 1.5, hjust = 1)
p
# improvement
index.HIV = which(data$HIV.percentage..15.49.years..2001 <10)
name.country = data$Country
name.country[index.HIV] = ''
p <- ggplot(data, aes(x=HIV.percentage..15.49.years..2001, y=TB.deaths.per.100.000.2001)) +
geom_point() + labs(x = 'HIV prevalence in 2001', y = "Tuberculosis deaths per 100,000 in 2001") +
ggtitle('HIV prevalence and tuberculosis deaths in 2001 in Sub-Saharan countries') + theme_grey(base_size = 16)+
theme(plot.title = element_text(size=16, hjust = 0.5)) + scale_y_continuous(breaks = c(seq(0, 450, 50))) +
geom_text(label=name.country, size= 8, vjust = 1.5, hjust = 1)
p
# improvement
index.HIV = which(data$HIV.percentage..15.49.years..2001 <10)
name.country = data$Country
name.country[index.HIV] = ''
p <- ggplot(data, aes(x=HIV.percentage..15.49.years..2001, y=TB.deaths.per.100.000.2001)) +
geom_point() + labs(x = 'HIV prevalence in 2001', y = "Tuberculosis deaths per 100,000 in 2001") +
ggtitle('HIV prevalence and tuberculosis deaths in 2001 in Sub-Saharan countries') + theme_grey(base_size = 16)+
theme(plot.title = element_text(size=16, hjust = 0.5)) + scale_y_continuous(breaks = c(seq(0, 450, 50))) +
geom_text(label=name.country, size= 6, vjust = 1.5, hjust = 1)
p
# improvement
index.HIV = which(data$HIV.percentage..15.49.years..2001 <10)
name.country = data$Country
name.country[index.HIV] = ''
p <- ggplot(data, aes(x=HIV.percentage..15.49.years..2001, y=TB.deaths.per.100.000.2001)) +
geom_point() + labs(x = 'HIV prevalence in 2001', y = "Tuberculosis deaths per 100,000 in 2001") +
ggtitle('HIV prevalence and tuberculosis deaths in 2001 in Sub-Saharan countries') + theme_grey(base_size = 16)+
theme(plot.title = element_text(size=16, hjust = 0.5)) + scale_y_continuous(breaks = c(seq(0, 450, 50))) +
geom_text(label=name.country, size= 6, vjust = 1, hjust = 1)
p
# ----------
# Example 3
# ----------
p <- ggplot(data, aes(x = Country, y=TB.deaths.per.100.000.2001)) +
geom_point() +  labs(x = 'Countries', y = "Tuberculosis deaths per 100,000 in 2001") +
ggtitle('Tuberculosis deaths in 2001 in Sub-Saharan countries') + scale_y_continuous(breaks = c(seq(0, 450, 50))) +
theme(plot.title = element_text(size=12, hjust = 0.5))
p
# ----------
# Example 3
# ----------
p <- ggplot(data, aes(x = Country, y=TB.deaths.per.100.000.2001)) +
geom_point() +  labs(x = 'Countries', y = "Tuberculosis deaths per 100,000 in 2001") + theme_grey(base_size = 16) +
ggtitle('Tuberculosis deaths in 2001 in Sub-Saharan countries') + scale_y_continuous(breaks = c(seq(0, 450, 50))) +
theme(plot.title = element_text(size=12, hjust = 0.5))
p
p <- ggplot(data, aes(x = Country, y=TB.deaths.per.100.000.2001)) +
geom_point() +  labs(x = 'Countries', y = "Tuberculosis deaths per 100,000 in 2001") + theme_grey(base_size = 16) +
ggtitle('Tuberculosis deaths in 2001 in Sub-Saharan countries') + scale_y_continuous(breaks = c(seq(0, 450, 50))) +
theme(plot.title = element_text(size=12, hjust = 0.5), axis.text.x = element_text(angle = 60, hjust = 1))
p
p <- ggplot(data, aes(x = Country, y=TB.deaths.per.100.000.2001)) +
geom_point() +  labs(x = 'Countries', y = "Tuberculosis deaths per 100,000 in 2001") + theme_grey(base_size = 14) +
ggtitle('Tuberculosis deaths in 2001 in Sub-Saharan countries') + scale_y_continuous(breaks = c(seq(0, 450, 50))) +
theme(plot.title = element_text(size=12, hjust = 0.5), axis.text.x = element_text(angle = 60, hjust = 1))
p
p <- ggplot(data, aes(x = Country, y=TB.deaths.per.100.000.2001)) +
geom_point() +  labs(x = 'Countries', y = "Tuberculosis deaths per 100,000 in 2001") + theme_grey(base_size = 14) +
ggtitle('Tuberculosis deaths in 2001 in Sub-Saharan countries') + scale_y_continuous(breaks = c(seq(0, 450, 50))) +
theme(plot.title = element_text(size=16, hjust = 0.5), axis.text.x = element_text(angle = 60, hjust = 1))
p
# ----------
# Example 3
# ----------
p <- ggplot(data, aes(x = Country, y=TB.deaths.per.100.000.2001)) +
geom_point() +  labs(x = 'Countries', y = "Tuberculosis deaths per 100,000 in 2001") + theme_grey(base_size = 16) +
ggtitle('Tuberculosis deaths in 2001 in Sub-Saharan countries') + scale_y_continuous(breaks = c(seq(0, 450, 50))) +
theme(plot.title = element_text(size=16, hjust = 0.5))
p
p <- ggplot(data, aes(y = Country, x =TB.deaths.per.100.000.2001)) +
geom_point() +  labs(y = 'Countries', x = "Tuberculosis deaths per 100,000 in 2001") +  theme_grey(base_size = 14) +
ggtitle('Tuberculosis deaths in 2001 in Sub-Saharan countries') + scale_x_continuous(breaks = c(seq(0, 450, 50))) +
theme(plot.title = element_text(size=16, hjust = 0.5))
p
p <- ggplot(data, aes(y = Country, x =TB.deaths.per.100.000.2001)) +
geom_point() +  labs(y = 'Countries', x = "Tuberculosis deaths per 100,000 in 2001") +  theme_grey(base_size = 14) +
ggtitle('Tuberculosis deaths in 2001 in Sub-Saharan countries') + scale_x_continuous(breaks = c(seq(0, 450, 50))) +
theme(plot.title = element_text(size=16, hjust = 0.5), axis.text.y = element_text(size = 12))
p
p <- ggplot(data, aes(y = Country, x =TB.deaths.per.100.000.2001)) +
geom_point() +  labs(y = 'Countries', x = "Tuberculosis deaths per 100,000 in 2001") +  theme_grey(base_size = 14) +
ggtitle('Tuberculosis deaths in 2001 in Sub-Saharan countries') + scale_x_continuous(breaks = c(seq(0, 450, 50))) +
theme(plot.title = element_text(size=16, hjust = 0.5), axis.text.y = element_text(size = 10))
p
p <- ggplot(data, aes(y = Country, x =TB.deaths.per.100.000.2001)) +
geom_point() +  labs(y = 'Countries', x = "Tuberculosis deaths per 100,000 in 2001") +  theme_grey(base_size = 14) +
ggtitle('Tuberculosis deaths in 2001 in Sub-Saharan countries') + scale_x_continuous(breaks = c(seq(0, 450, 50))) +
theme(plot.title = element_text(size=16, hjust = 0.5), axis.text.y = element_text(size = 9))
p
p <- ggplot(data, aes(y = reorder(Country, TB.deaths.per.100.000.2001), x = TB.deaths.per.100.000.2001)) +
geom_point() +  labs(y = 'Countries', x = "Tuberculosis deaths per 100,000 in 2001") +
ggtitle('Tuberculosis deaths in 2001 in Sub-Saharan countries') + scale_x_continuous(breaks = c(seq(0, 450, 50))) +
theme(plot.title = element_text(size=12, hjust = 0.5))
p
p <- ggplot(data, aes(y = reorder(Country, TB.deaths.per.100.000.2001), x = TB.deaths.per.100.000.2001)) +
geom_point() +  theme_classic() +  labs(y = 'Countries', x = "Tuberculosis deaths per 100,000 in 2001") +
ggtitle('Tuberculosis deaths in 2001 in Sub-Saharan countries') + scale_x_continuous(breaks = c(seq(0, 450, 50))) +
theme(plot.title = element_text(size=12, hjust = 0.5))
p
p <- ggplot(data, aes(y = reorder(Country, TB.deaths.per.100.000.2001), x = TB.deaths.per.100.000.2001)) +  theme_grey(base_size = 14) +
geom_point() +  labs(y = 'Countries', x = "Tuberculosis deaths per 100,000 in 2001") +
ggtitle('Tuberculosis deaths in 2001 in Sub-Saharan countries') + scale_x_continuous(breaks = c(seq(0, 450, 50))) +
theme(plot.title = element_text(size=16, hjust = 0.5), axis.text.y = element_text(size = 9))
p
p <- ggplot(data, aes(y = reorder(Country, TB.deaths.per.100.000.2001), x = TB.deaths.per.100.000.2001)) +  theme_grey(base_size = 14) +
geom_point() +  labs(y = 'Countries', x = "Tuberculosis deaths per 100,000 in 2001") +
ggtitle('Tuberculosis deaths in 2001 in Sub-Saharan countries') + scale_x_continuous(breaks = c(seq(0, 450, 50))) +
theme(plot.title = element_text(size=16, hjust = 0.5), axis.text.y = element_text(size = 8.5))
p
# improved
# Basic box plot
p <- ggplot(data, aes(x=World.Bank.income.group.2001, y=TB.deaths.per.100.000.2001, fill = World.Bank.income.group.2001)) + theme_grey(base_size = 18) +
geom_boxplot() + labs(title="Tuberculosis deaths in 2001 in Sub-Saharan countries", x = 'World Bank income group in 2001', y = "Tuberculosis deaths per 100,000 in 2001")+
theme(plot.title = element_text(hjust = 0.5), legend.position="none") + scale_fill_brewer(palette="Dark2")
p
# improved
# Basic box plot
p <- ggplot(data, aes(x=World.Bank.income.group.2001, y=TB.deaths.per.100.000.2001, fill = World.Bank.income.group.2001)) + theme_grey(base_size = 18) +
geom_boxplot() + labs(title="Tuberculosis deaths in 2001 in Sub-Saharan countries", x = 'World Bank income group in 2001', y = "Tuberculosis deaths per 100,000 in 2001")+
theme(plot.title = element_text(size=16, hjust = 0.5), legend.position="none") + scale_fill_brewer(palette="Dark2")
p
p <- ggplot(data, aes(x = Country, y=TB.deaths.per.100.000.2001)) +
geom_point() +  labs(x = 'Countries', y = "Tuberculosis deaths per 100,000 in 2001") + theme_grey(base_size = 14) +
ggtitle('Tuberculosis deaths in 2001 in Sub-Saharan countries') + scale_y_continuous(breaks = c(seq(0, 450, 50))) +
theme(plot.title = element_text(size=16, hjust = 0.5), axis.text.x = element_text(size = 14, angle = 60, hjust = 1))
p
p <- ggplot(data, aes(x = Country, y=TB.deaths.per.100.000.2001)) +
geom_point() +  labs(x = 'Countries', y = "Tuberculosis deaths per 100,000 in 2001") + theme_grey(base_size = 14) +
ggtitle('Tuberculosis deaths in 2001 in Sub-Saharan countries') + scale_y_continuous(breaks = c(seq(0, 450, 50))) +
theme(plot.title = element_text(size=16, hjust = 0.5), axis.text.x = element_text(size = 10, angle = 60, hjust = 1))
p
p <- ggplot(data, aes(x = Country, y=TB.deaths.per.100.000.2001)) +
geom_point() +  labs(x = 'Countries', y = "Tuberculosis deaths per 100,000 in 2001") + theme_grey(base_size = 14) +
ggtitle('Tuberculosis deaths in 2001 in Sub-Saharan countries') + scale_y_continuous(breaks = c(seq(0, 450, 50))) +
theme(plot.title = element_text(size=16, hjust = 0.5), axis.text.x = element_text(size = 10, angle = 60, hjust = 1), axis.title.x = element_text(size = 12))
p
p <- ggplot(data, aes(x = Country, y=TB.deaths.per.100.000.2001)) +
geom_point() +  labs(x = 'Countries', y = "Tuberculosis deaths per 100,000 in 2001") + theme_grey(base_size = 14) +
ggtitle('Tuberculosis deaths in 2001 in Sub-Saharan countries') + scale_y_continuous(breaks = c(seq(0, 450, 50))) +
theme(plot.title = element_text(size=16, hjust = 0.5), axis.text.x = element_text(size = 10, angle = 60, hjust = 1), axis.title.y = element_text(size = 12))
p
p <- ggplot(data, aes(x = Country, y=TB.deaths.per.100.000.2001)) +
geom_point() +  labs(x = 'Countries', y = "Tuberculosis deaths per 100,000 in 2001") + theme_grey(base_size = 14) +
ggtitle('Tuberculosis deaths in 2001 in Sub-Saharan countries') + scale_y_continuous(breaks = c(seq(0, 450, 50))) +
theme(plot.title = element_text(size=16, hjust = 0.5), axis.text.x = element_text(size = 10, angle = 60, hjust = 1), axis.title.y = element_text(size = 12))
p
p <- ggplot(data, aes(x = Country, y=TB.deaths.per.100.000.2001)) +
geom_point() +  labs(x = 'Countries', y = "Tuberculosis deaths per 100,000 in 2001") + theme_grey(base_size = 14) +
ggtitle('Tuberculosis deaths in 2001 in Sub-Saharan countries') + scale_y_continuous(breaks = c(seq(0, 450, 50))) +
theme(plot.title = element_text(size=16, hjust = 0.5), axis.text.x = element_text(size = 10, angle = 60, hjust = 1), axis.title.y = element_text(size = 11))
p
p <- ggplot(data, aes(y = Country, x =TB.deaths.per.100.000.2001)) +
geom_point() +  labs(y = 'Countries', x = "Tuberculosis deaths per 100,000 in 2001") +  theme_grey(base_size = 14) +
ggtitle('Tuberculosis deaths in 2001 in Sub-Saharan countries') + scale_x_continuous(breaks = c(seq(0, 450, 50))) +
theme(plot.title = element_text(size=16, hjust = 0.5), axis.text.y = element_text(size = 9))
p
2715/68
2715/68
2356 /43
setwd("~/Documents/Articles")
data = read.csv('conferences summary.csv')
data
# -----------------------------
# combined
# ----------------------------
data = read.csv('conferences summary.csv')
data
data$combined = factor(data$combined, levels = c('workshop', 'conference', 'keynote', 'chair'),
labels = c('Symposium', 'Conference', 'Keynote', 'Chair'))
data$combined
summary(data$combined)
National = summary(data$combined[which((data$venue == 'national') & (data$year >= 2013))])
International = summary(data$combined[which((data$venue == 'international') & (data$year >= 2013))])
counts = t(as.matrix(data.frame(International, National)))
counts
# -----------------------------
# combined
# ----------------------------
data = read.csv('conferences summary.csv')
data
data$combined = factor(data$combined, levels = c('workshop', 'conference', 'keynote', 'chair'),
labels = c('Symposium', 'Conference', 'Keynote', 'Chair'))
summary(data$combined)
National = summary(data$combined[which((data$venue == 'national') & (data$year >= 2013))])
International = summary(data$combined[which((data$venue == 'international') & (data$year >= 2013))])
counts = t(as.matrix(data.frame(International, National)))
counts
# Symposium Conference Keynote Chair
# International         8          4       1     1
# National              9          1       2     2
apply(counts, 2, sum)
# Symposium Conference    Keynote      Chair
# 17          5          3          3
apply(counts, 1, sum)
#https://cran.r-project.org/web/packages/dlstats/vignettes/dlstats.html
library("ggplot2")
library("dlstats")
dl2018 <- cran_stats(c("mixOmics"))
head(dl2018)
# calculated cumulative dl
sum(dl2018[which(substr(dl2018$start, 1,4) == '2018'), 'downloads'])
294+259+205+192+95+70+62+61+57+23
294+259+205+192+95+70+62+61+57+23+14+10
setwd("~/Documents/Packages/mixOmics/Bioconductor/Vignette/Bookdown")
setwd("~/Documents/Packages/mixOmics/Workshops/2018/MAW18/Case studies")
library(MOFAtools)
# try again
devtools::install_github("PMBio/MOFA", subdir="MOFAtools")
library(MOFAtools)
data("scMT_data")
scMT_data
library(MultiAssayExperiment)
data.scMT = assays(scMT_data)  # SingleCellExperiment object
lapply(data.scMT, dim)
# more details about the samples
library(MultiAssayExperiment)
experiments(scMT_data)  # note here: not all cells are matching!
colData(scMT_data)  # some info about those that pass QC
colnames(colData(scMT_data))
colData(scMT_data)$pass_metQC
colData(scMT_data)$culture
cbind(rownames(colData(scMT_data)), colData(scMT_data)$culture)
culture.mofa  = colData(scMT_data)$culture
names(culture.mofa) = rownames(colData(scMT_data))
# work out which samples are repeated across all omics
summary.per.cell = table(sampleMap(scMT_data)$assay, sampleMap(scMT_data)$colname)
cell.name.omics = names(which(apply(summary.per.cell, 2, sum) == 4))
# match then extract data for DIABLO analysis
data.RNA.tmp = data.scMT[[1]]
data.Enh.tmp = data.scMT[[2]]
data.CpG.tmp = data.scMT[[3]]
data.Prom.tmp = data.scMT[[4]]
cell.name.omics = Reduce(intersect,
list(colnames(data.RNA.tmp),colnames(data.Enh.tmp),colnames(data.CpG.tmp), colnames(data.Prom.tmp)))
length(cell.name.omics)
data.RNA = t(data.RNA.tmp[, cell.name.omics])
data.Enhancer = t(data.Enh.tmp[, cell.name.omics])
data.CpG = t(data.CpG.tmp[, cell.name.omics])
data.Promoter = t(data.Prom.tmp[, cell.name.omics])
culture.info = colData(scMT_data)$culture
names(culture.info) = rownames(colData(scMT_data))
cell.type = as.factor(culture.info[cell.name.omics])
summary(cell.type)
library(mixOmics)
pca.res = pca(data.RNA, ncomp = 3)
plot(pca.res)
plotIndiv(pca.res, group = cell.type, legend = TRUE)
# wonder what happens when we merge all met datasets?
data.met = data.Enhancer+data.CpG+data.Promoter
data.met[1:5,1:5]  # nopte, still need to combine those variables
pca.res = pca(data.Enhancer, ncomp = 3)
plot(pca.res)
plotIndiv(pca.res, group = cell.type, legend = TRUE)
length(apply(data.Enhancer, 2, is.na))
data.CpG[,1:5]
dim(data.RNA)
data.RNA[1:5,1:5]
data.Enhancer[1:5,1:5]
sum(is.na(data.Enhancer))
sum(is.na(data.CpG))   # [1] 324839
sum(is.na(data.Promoter))   # [1] 293751
# write data for Heather / Al
write.csv(data.Enhancer, 'data.Enhancer.csv')
write.csv(data.CpG, 'data.CpG.csv')
write.csv(data.Promoter, 'data.Promoter.csv')
write.csv(data.RNA, 'data.RNA.csv')
setwd("~/Documents/Projects/Single Cell Seq/Benchmark SC data")
load('Data/ResultscMT.RData')
lapply(data, dim)
names(data)
names(y) = rownames(data$mRNA)
Y  = y
block.data = data
# checking dimension
lapply(block.data, dim)
# set up a full design where every block is connected
design = matrix(1, ncol = length(block.data), nrow = length(block.data),
dimnames = list(names(block.data), names(block.data)))
diag(design) =  0
design
# set number of component per data set
ncomp = c(2)
# set number of variables to select, per component and per data set (this is set arbitrarily)
list.keepX = list(mRNA = c(20, 20), met = c(20, 20))
block.splsda = block.splsda(X = block.data, Y = y,
ncomp = ncomp, keepX = list.keepX,  design = design)
lapply(data, dim)
# write data to show Heather / Al
write.csv(data$met, 'data.methylation.Angermueller.csv')
lapply(data.scMT, dim)
5 *4*3
10 *4*3
