<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>mixOmics vignette</title>
  <meta name="description" content="Vignette for the R package mixOmics">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="mixOmics vignette" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Vignette for the R package mixOmics" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="mixOmics vignette" />
  
  <meta name="twitter:description" content="Vignette for the R package mixOmics" />
  

<meta name="author" content="Kim-Anh Le Cao &amp; Sebastien Dejean">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="start.html">
<link rel="next" href="plsda.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#intro:datatypes"><i class="fa fa-check"></i><b>1.1</b> Input data</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#methods"><i class="fa fa-check"></i><b>1.2</b> Methods</a><ul>
<li class="chapter" data-level="1.2.1" data-path="intro.html"><a href="intro.html#intro:background"><i class="fa fa-check"></i><b>1.2.1</b> Some background knowledge</a></li>
<li class="chapter" data-level="1.2.2" data-path="intro.html"><a href="intro.html#intro:overview"><i class="fa fa-check"></i><b>1.2.2</b> Overview</a></li>
<li class="chapter" data-level="1.2.3" data-path="intro.html"><a href="intro.html#intro:pubs"><i class="fa fa-check"></i><b>1.2.3</b> Key publications</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#outline-of-this-vignette"><i class="fa fa-check"></i><b>1.3</b> Outline of this Vignette</a></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#other-methods-not-covered-in-this-vignette"><i class="fa fa-check"></i><b>1.4</b> Other methods not covered in this vignette</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="start.html"><a href="start.html"><i class="fa fa-check"></i><b>2</b> Let’s get started</a><ul>
<li class="chapter" data-level="2.1" data-path="start.html"><a href="start.html#installation"><i class="fa fa-check"></i><b>2.1</b> Installation</a></li>
<li class="chapter" data-level="2.2" data-path="start.html"><a href="start.html#start:upload"><i class="fa fa-check"></i><b>2.2</b> Load the package</a></li>
<li class="chapter" data-level="2.3" data-path="start.html"><a href="start.html#upload-data"><i class="fa fa-check"></i><b>2.3</b> Upload data</a></li>
<li class="chapter" data-level="2.4" data-path="start.html"><a href="start.html#start:PCA"><i class="fa fa-check"></i><b>2.4</b> Quick start in <code>mixOmics</code></a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="pca.html"><a href="pca.html"><i class="fa fa-check"></i><b>3</b> Principal Component Analysis (PCA)</a><ul>
<li class="chapter" data-level="3.1" data-path="pca.html"><a href="pca.html#biological-question"><i class="fa fa-check"></i><b>3.1</b> Biological question</a></li>
<li class="chapter" data-level="3.2" data-path="pca.html"><a href="pca.html#the-liver.toxicity-study"><i class="fa fa-check"></i><b>3.2</b> The <code>liver.toxicity</code> study</a></li>
<li class="chapter" data-level="3.3" data-path="pca.html"><a href="pca.html#principle-of-pca"><i class="fa fa-check"></i><b>3.3</b> Principle of PCA</a></li>
<li class="chapter" data-level="3.4" data-path="pca.html"><a href="pca.html#load-the-data"><i class="fa fa-check"></i><b>3.4</b> Load the data</a></li>
<li class="chapter" data-level="3.5" data-path="pca.html"><a href="pca.html#quick-start"><i class="fa fa-check"></i><b>3.5</b> Quick start</a></li>
<li class="chapter" data-level="3.6" data-path="pca.html"><a href="pca.html#to-go-further"><i class="fa fa-check"></i><b>3.6</b> To go further</a><ul>
<li class="chapter" data-level="3.6.1" data-path="pca.html"><a href="pca.html#customize-plots"><i class="fa fa-check"></i><b>3.6.1</b> Customize plots</a></li>
<li class="chapter" data-level="3.6.2" data-path="pca.html"><a href="pca.html#amount-of-variance-explained-and-choice-of-number-of-components"><i class="fa fa-check"></i><b>3.6.2</b> Amount of variance explained and choice of number of components</a></li>
<li class="chapter" data-level="3.6.3" data-path="pca.html"><a href="pca.html#other-useful-plots"><i class="fa fa-check"></i><b>3.6.3</b> Other useful plots</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="pca.html"><a href="pca.html#sPCA"><i class="fa fa-check"></i><b>3.7</b> Variable selection with sparse PCA</a><ul>
<li class="chapter" data-level="3.7.1" data-path="pca.html"><a href="pca.html#biological-question-1"><i class="fa fa-check"></i><b>3.7.1</b> Biological question</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="pca.html"><a href="pca.html#tuning-parameters"><i class="fa fa-check"></i><b>3.8</b> Tuning parameters</a></li>
<li class="chapter" data-level="3.9" data-path="pca.html"><a href="pca.html#additional-resources"><i class="fa fa-check"></i><b>3.9</b> Additional resources</a></li>
<li class="chapter" data-level="3.10" data-path="pca.html"><a href="pca.html#faq"><i class="fa fa-check"></i><b>3.10</b> FAQ</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="plsda.html"><a href="plsda.html"><i class="fa fa-check"></i><b>4</b> PLS - Discriminant Analysis (PLS-DA)</a><ul>
<li class="chapter" data-level="4.1" data-path="plsda.html"><a href="plsda.html#biological-question-2"><i class="fa fa-check"></i><b>4.1</b> Biological question</a></li>
<li class="chapter" data-level="4.2" data-path="plsda.html"><a href="plsda.html#the-srbct-study"><i class="fa fa-check"></i><b>4.2</b> The <code>srbct</code> study</a></li>
<li class="chapter" data-level="4.3" data-path="plsda.html"><a href="plsda.html#principle-of-sparse-pls-da"><i class="fa fa-check"></i><b>4.3</b> Principle of sparse PLS-DA</a></li>
<li class="chapter" data-level="4.4" data-path="plsda.html"><a href="plsda.html#inputs-and-outputs"><i class="fa fa-check"></i><b>4.4</b> Inputs and outputs</a></li>
<li class="chapter" data-level="4.5" data-path="plsda.html"><a href="plsda.html#set-up-the-data"><i class="fa fa-check"></i><b>4.5</b> Set up the data</a></li>
<li class="chapter" data-level="4.6" data-path="plsda.html"><a href="plsda.html#quick-start-1"><i class="fa fa-check"></i><b>4.6</b> Quick start</a></li>
<li class="chapter" data-level="4.7" data-path="plsda.html"><a href="plsda.html#plsda-tgf"><i class="fa fa-check"></i><b>4.7</b> To go further</a><ul>
<li class="chapter" data-level="4.7.1" data-path="plsda.html"><a href="plsda.html#splsda:plotIndiv"><i class="fa fa-check"></i><b>4.7.1</b> Customize sample plots</a></li>
<li class="chapter" data-level="4.7.2" data-path="plsda.html"><a href="plsda.html#customize-variable-plots"><i class="fa fa-check"></i><b>4.7.2</b> Customize variable plots</a></li>
<li class="chapter" data-level="4.7.3" data-path="plsda.html"><a href="plsda.html#other-useful-plots-1"><i class="fa fa-check"></i><b>4.7.3</b> Other useful plots</a></li>
<li class="chapter" data-level="4.7.4" data-path="plsda.html"><a href="plsda.html#variable-selection-outputs"><i class="fa fa-check"></i><b>4.7.4</b> Variable selection outputs</a></li>
<li class="chapter" data-level="4.7.5" data-path="plsda.html"><a href="plsda.html#tuning:sPLSDA"><i class="fa fa-check"></i><b>4.7.5</b> Tuning parameters and numerical outputs</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="plsda.html"><a href="plsda.html#additional-resources-1"><i class="fa fa-check"></i><b>4.8</b> Additional resources</a></li>
<li class="chapter" data-level="4.9" data-path="plsda.html"><a href="plsda.html#faq-1"><i class="fa fa-check"></i><b>4.9</b> FAQ</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="pls.html"><a href="pls.html"><i class="fa fa-check"></i><b>5</b> Projection to Latent Structure (PLS)</a><ul>
<li class="chapter" data-level="5.1" data-path="pls.html"><a href="pls.html#biological-question-3"><i class="fa fa-check"></i><b>5.1</b> Biological question</a></li>
<li class="chapter" data-level="5.2" data-path="pls.html"><a href="pls.html#the-nutrimouse-study"><i class="fa fa-check"></i><b>5.2</b> The <code>nutrimouse</code> study</a></li>
<li class="chapter" data-level="5.3" data-path="pls.html"><a href="pls.html#principle-of-pls"><i class="fa fa-check"></i><b>5.3</b> Principle of PLS</a></li>
<li class="chapter" data-level="5.4" data-path="pls.html"><a href="pls.html#principle-of-sparse-pls"><i class="fa fa-check"></i><b>5.4</b> Principle of sparse PLS</a></li>
<li class="chapter" data-level="5.5" data-path="pls.html"><a href="pls.html#inputs-and-outputs-1"><i class="fa fa-check"></i><b>5.5</b> Inputs and outputs</a></li>
<li class="chapter" data-level="5.6" data-path="pls.html"><a href="pls.html#set-up-the-data-1"><i class="fa fa-check"></i><b>5.6</b> Set up the data</a></li>
<li class="chapter" data-level="5.7" data-path="pls.html"><a href="pls.html#quick-start-2"><i class="fa fa-check"></i><b>5.7</b> Quick start</a></li>
<li class="chapter" data-level="5.8" data-path="pls.html"><a href="pls.html#pls-tgf"><i class="fa fa-check"></i><b>5.8</b> To go further</a><ul>
<li class="chapter" data-level="5.8.1" data-path="pls.html"><a href="pls.html#pls:plotIndiv"><i class="fa fa-check"></i><b>5.8.1</b> Customize sample plots</a></li>
<li class="chapter" data-level="5.8.2" data-path="pls.html"><a href="pls.html#pls:plotVar"><i class="fa fa-check"></i><b>5.8.2</b> Customize variable plots</a></li>
<li class="chapter" data-level="5.8.3" data-path="pls.html"><a href="pls.html#other-useful-plots-for-data-integration"><i class="fa fa-check"></i><b>5.8.3</b> Other useful plots for data integration</a></li>
<li class="chapter" data-level="5.8.4" data-path="pls.html"><a href="pls.html#variable-selection-outputs-1"><i class="fa fa-check"></i><b>5.8.4</b> Variable selection outputs</a></li>
<li class="chapter" data-level="5.8.5" data-path="pls.html"><a href="pls.html#tuning:PLS"><i class="fa fa-check"></i><b>5.8.5</b> Tuning parameters and numerical outputs</a></li>
<li class="chapter" data-level="5.8.6" data-path="pls.html"><a href="pls.html#PLS:details"><i class="fa fa-check"></i><b>5.8.6</b> PLS modes</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="pls.html"><a href="pls.html#additional-resources-2"><i class="fa fa-check"></i><b>5.9</b> Additional resources</a></li>
<li class="chapter" data-level="5.10" data-path="pls.html"><a href="pls.html#faq-2"><i class="fa fa-check"></i><b>5.10</b> FAQ</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="diablo.html"><a href="diablo.html"><i class="fa fa-check"></i><b>6</b> Multi-block Discriminant Analysis with DIABLO</a><ul>
<li class="chapter" data-level="6.1" data-path="diablo.html"><a href="diablo.html#biological-question-4"><i class="fa fa-check"></i><b>6.1</b> Biological question</a></li>
<li class="chapter" data-level="6.2" data-path="diablo.html"><a href="diablo.html#the-breast.tcga-study"><i class="fa fa-check"></i><b>6.2</b> The <code>breast.TCGA</code> study</a></li>
<li class="chapter" data-level="6.3" data-path="diablo.html"><a href="diablo.html#principle-of-diablo"><i class="fa fa-check"></i><b>6.3</b> Principle of DIABLO</a></li>
<li class="chapter" data-level="6.4" data-path="diablo.html"><a href="diablo.html#inputs-and-outputs-2"><i class="fa fa-check"></i><b>6.4</b> Inputs and outputs</a></li>
<li class="chapter" data-level="6.5" data-path="diablo.html"><a href="diablo.html#set-up-the-data-2"><i class="fa fa-check"></i><b>6.5</b> Set up the data</a></li>
<li class="chapter" data-level="6.6" data-path="diablo.html"><a href="diablo.html#quick-start-3"><i class="fa fa-check"></i><b>6.6</b> Quick start</a></li>
<li class="chapter" data-level="6.7" data-path="diablo.html"><a href="diablo.html#to-go-further-1"><i class="fa fa-check"></i><b>6.7</b> To go further</a><ul>
<li class="chapter" data-level="6.7.1" data-path="diablo.html"><a href="diablo.html#diablo:plotIndiv"><i class="fa fa-check"></i><b>6.7.1</b> Customize sample plots</a></li>
<li class="chapter" data-level="6.7.2" data-path="diablo.html"><a href="diablo.html#diablo:plotVar"><i class="fa fa-check"></i><b>6.7.2</b> Customize variable plots</a></li>
<li class="chapter" data-level="6.7.3" data-path="diablo.html"><a href="diablo.html#other-useful-plots-for-data-integration-1"><i class="fa fa-check"></i><b>6.7.3</b> Other useful plots for data integration</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="diablo.html"><a href="diablo.html#numerical-outputs"><i class="fa fa-check"></i><b>6.8</b> Numerical outputs</a><ul>
<li class="chapter" data-level="6.8.1" data-path="diablo.html"><a href="diablo.html#classification-performance"><i class="fa fa-check"></i><b>6.8.1</b> Classification performance</a></li>
<li class="chapter" data-level="6.8.2" data-path="diablo.html"><a href="diablo.html#auc"><i class="fa fa-check"></i><b>6.8.2</b> AUC</a></li>
<li class="chapter" data-level="6.8.3" data-path="diablo.html"><a href="diablo.html#tuning-parameters-1"><i class="fa fa-check"></i><b>6.8.3</b> Tuning parameters</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="diablo.html"><a href="diablo.html#additional-resources-3"><i class="fa fa-check"></i><b>6.9</b> Additional resources</a></li>
<li class="chapter" data-level="6.10" data-path="diablo.html"><a href="diablo.html#faq-3"><i class="fa fa-check"></i><b>6.10</b> FAQ</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="session-information.html"><a href="session-information.html"><i class="fa fa-check"></i><b>7</b> Session Information</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">mixOmics vignette</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="pca" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> Principal Component Analysis (PCA)</h1>
<p><img src="Figures/overview-PCA-1.png" width="50%" style="display: block; margin: auto;" /></p>
<div id="biological-question" class="section level2">
<h2><span class="header-section-number">3.1</span> Biological question</h2>
<p><span style="color:blue"> <em>I would like to identify the major sources of variation in my data and itdentify whether such sources of variation correspond to biological conditions, or experimental bias. I would like visualise trends or patterns between samples,whether they ‘naturally’ cluster according to known biological conditions.</em> </span></p>
</div>
<div id="the-liver.toxicity-study" class="section level2">
<h2><span class="header-section-number">3.2</span> The <code>liver.toxicity</code> study</h2>
<p>The <code>liver.toxicity</code> is a list in the package that contains:</p>
<ul>
<li><p><code>gene</code>: a data frame with 64 rows and 3116 columns, corresponding to the expression levels of 3,116 genes measured on 64 rats.</p></li>
<li><p><code>clinic</code>: a data frame with 64 rows and 10 columns, corresponding to the measurements of 10 clinical variables on the same 64 rats.</p></li>
<li><p><code>treatment</code>: data frame with 64 rows and 4 columns, indicating the treatment information of the 64 rats, such as doses of acetaminophen and times of necropsy.</p></li>
<li><p><code>gene.ID</code>: a data frame with 3116 rows and 2 columns, indicating geneBank IDs of the annotated genes.</p></li>
</ul>
<p>More details are available at <code>?liver.toxicity</code>.</p>
<p>To illustrate PCA, we focus on the expression levels of the genes in the data frame <code>liver.toxicity$gene</code>. Some of the terms mentioned below are listed in <a href="intro.html#intro:background">1.2.1</a>.</p>
</div>
<div id="principle-of-pca" class="section level2">
<h2><span class="header-section-number">3.3</span> Principle of PCA</h2>
<p>The aim of PCA <span class="citation">(Jolliffe <a href="#ref-Jol05">2005</a>)</span> is to reduce the dimensionality of the data whilst retaining as much information as possible. ‘Information’ is referred here as <em>variance</em>. The idea is to create uncorrelated artificial variables called <em>principal components</em> (PCs) that combine in a linear manner the original (possibly correlated) variables (e.g. genes, metabolites, etc.).</p>
<p>Dimension reduction is achieved by projecting the data into the space spanned by the principal components (PC). In practice, it means that each sample is assigned a score on each new PC dimension - this score is calculated as a linear combination of the original variables to which a weight is applied. The weights of each of the original variables are stored in the so-called <em>loading vectors</em> associated to each PC. The dimension of the data is reduced by projecting the data into the smaller subspace spanned by the PCs, while capturing the largest sources of variation between samples.</p>
<p>The principal components are obtained by maximising the variance-covariance matrix of the data. To that end, we calculate the eigenvectors/eigenvalues of the variance-covariance matrix, often via singular value decomposition when the number of variables is very large. The data are usually centred (<code>center = TRUE</code>), and sometimes scaled (<code>scale = TRUE</code>) in the method. The latter is especially advised in the case where the variance is not homogeneous across variables.</p>
<p>The first PC is defined as the linear combination of the original variables that explains the greatest amount of variation. The second PC is then defined as the linear combination of the original variables that accounts for the greatest amount of the remaining variation subject of being orthogonal (uncorrelated) to the first component. Subsequent components are defined likewise for the other PCA dimensions. The user must therefore report how much information is explained by the first PCs as these are used to graphically represent the PCA outputs.</p>
</div>
<div id="load-the-data" class="section level2">
<h2><span class="header-section-number">3.4</span> Load the data</h2>
<p>We first load the data from the package. See <a href="start.html#start:upload">2.2</a> to upload your own data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(mixOmics)
<span class="kw">data</span>(liver.toxicity)
X &lt;-<span class="st"> </span>liver.toxicity<span class="op">$</span>gene</code></pre></div>
</div>
<div id="quick-start" class="section level2">
<h2><span class="header-section-number">3.5</span> Quick start</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">MyResult.pca &lt;-<span class="st"> </span><span class="kw">pca</span>(X)     <span class="co"># 1 Run the method</span>
<span class="kw">plotIndiv</span>(MyResult.pca)    <span class="co"># 2 Plot the samples</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plotVar</span>(MyResult.pca)      <span class="co"># 3 Plot the variables</span></code></pre></div>
<p>If you were to run <code>pca</code> with this minimal code, you would be using the following default values:</p>
<ul>
<li><code>ncomp =2</code>: the first two principal components are calculated and are used for graphical outputs;</li>
<li><code>center = TRUE</code>: data are centred (mean = 0)</li>
<li><code>scale = FALSE</code>: data are not scaled. If <code>scale = TRUE</code> standardizes each variable (variance = 1).</li>
</ul>
<p>Other arguments can also be chosen, see <code>?pca</code>.</p>
<p>This example was shown in Chapter <a href="start.html#start:PCA">2.4</a>. The two plots are not extremely meaningful as specific sample patterns should be further investigated and the variable correlation circle plot plot contains too many variables to be easily interpreted. Let’s improve those graphics as shown below to improve interpretation.</p>
</div>
<div id="to-go-further" class="section level2">
<h2><span class="header-section-number">3.6</span> To go further</h2>
<div id="customize-plots" class="section level3">
<h3><span class="header-section-number">3.6.1</span> Customize plots</h3>
<p>Plots can be customized using numerous options in <code>plotIndiv</code> and <code>plotVar</code>. For instance, even if PCA does not take into account any information regarding the known group membership of each sample, we can include such information on the sample plot to visualize any `natural’ cluster that may corresponds to biological conditions.</p>
<p>Here is an example where we include the sample groups information with the argument <code>group</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plotIndiv</span>(MyResult.pca, <span class="dt">group =</span> liver.toxicity<span class="op">$</span>treatment<span class="op">$</span>Dose.Group, 
          <span class="dt">legend =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p><img src="Figures/unnamed-chunk-3-1.png" width="50%" style="display: block; margin: auto;" /></p>
<p>Additionally, two factors can be displayed using both colours (argument <code>group</code>) and symbols (argument <code>pch</code>). For example here we display both Dose and Time of exposure and improve the title and legend:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plotIndiv</span>(MyResult.pca, <span class="dt">ind.names =</span> <span class="ot">FALSE</span>,
          <span class="dt">group =</span> liver.toxicity<span class="op">$</span>treatment<span class="op">$</span>Dose.Group,
          <span class="dt">pch =</span> <span class="kw">as.factor</span>(liver.toxicity<span class="op">$</span>treatment<span class="op">$</span>Time.Group),
          <span class="dt">legend =</span> <span class="ot">TRUE</span>, <span class="dt">title =</span> <span class="st">&#39;Liver toxicity: genes, PCA comp 1 - 2&#39;</span>,
          <span class="dt">legend.title =</span> <span class="st">&#39;Dose&#39;</span>, <span class="dt">legend.title.pch =</span> <span class="st">&#39;Exposure&#39;</span>)</code></pre></div>
<p><img src="Figures/unnamed-chunk-4-1.png" width="50%" style="display: block; margin: auto;" /></p>
<p>By including information related to the dose of acetaminophen and time of exposure enables us to see a cluster of low dose samples (blue and orange, top left at 50 and 100mg respectively), whereas samples with high doses (1500 and 2000mg in grey and green respectively) are more scattered, but highlight an exposure effect.</p>
<p>To display the results on other components, we can change the <code>comp</code> argument provided we have requested enough components to be calculated. Here is our second PCA with 3 components:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">MyResult.pca2 &lt;-<span class="st"> </span><span class="kw">pca</span>(X, <span class="dt">ncomp =</span> <span class="dv">3</span>)
<span class="kw">plotIndiv</span>(MyResult.pca2, <span class="dt">comp =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>), <span class="dt">legend =</span> <span class="ot">TRUE</span>,
          <span class="dt">group =</span> liver.toxicity<span class="op">$</span>treatment<span class="op">$</span>Time.Group,
          <span class="dt">title =</span> <span class="st">&#39;Multidrug transporter, PCA comp 1 - 3&#39;</span>)</code></pre></div>
<p><img src="Figures/unnamed-chunk-5-1.png" width="50%" style="display: block; margin: auto;" /></p>
<p>Here, the 3rd component on the y-axis clearly highlights a time of exposure effect.</p>
</div>
<div id="amount-of-variance-explained-and-choice-of-number-of-components" class="section level3">
<h3><span class="header-section-number">3.6.2</span> Amount of variance explained and choice of number of components</h3>
<p>The amount of variance explained can be extracted with the following: a screeplot or the actual numerical proportions of explained variance, and cumulative proportion.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(MyResult.pca2)</code></pre></div>
<p><img src="Figures/unnamed-chunk-6-1.png" width="50%" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">MyResult.pca2</code></pre></div>
<pre><code>## Eigenvalues for the first 3 principal components, see object$sdev^2: 
##       PC1       PC2       PC3 
## 17.971416  9.079234  4.567709 
## 
## Proportion of explained variance for the first 3 principal components, see object$explained_variance: 
##        PC1        PC2        PC3 
## 0.35684128 0.18027769 0.09069665 
## 
## Cumulative proportion explained variance for the first 3 principal components, see object$cum.var: 
##       PC1       PC2       PC3 
## 0.3568413 0.5371190 0.6278156 
## 
##  Other available components: 
##  -------------------- 
##  loading vectors: see object$rotation</code></pre>
<p>There is no clear guidelines on how many components should be included in PCA: it is data dependent and the level of noise. We often look at the `elbow’ on the screeplot above as an indicator that the addition of PCs does not drastically contribute to explain the remainder variance.</p>
</div>
<div id="other-useful-plots" class="section level3">
<h3><span class="header-section-number">3.6.3</span> Other useful plots</h3>
<p>We can also have a look at the variable coefficients in each component with the loading vectors. The loading weights are represented in decreasing order from bottom to top in <code>plotLoadings</code>. Their absolute value indicates the importance of each variable to define each PC, as represented by the length of each bar. See <code>?plotLoadings</code> to change the arguments.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># a minimal example</span>
<span class="kw">plotLoadings</span>(MyResult.pca)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># a customized example to only show the top 100 genes </span>
<span class="co"># and their gene name</span>
<span class="kw">plotLoadings</span>(MyResult.pca, <span class="dt">ndisplay =</span> <span class="dv">100</span>, 
             <span class="dt">name.var =</span> liver.toxicity<span class="op">$</span>gene.ID[, <span class="st">&quot;geneBank&quot;</span>],
             <span class="dt">size.name =</span> <span class="kw">rel</span>(<span class="fl">0.3</span>))</code></pre></div>
<p>Such representation will be more informative once we select a few variables in the next section <a href="pca.html#sPCA">3.7</a>.</p>
<p>Plots can also be displayed in 3 dimensions using the option <code>style=&quot;3d&quot;</code>, and interactively (we use the <code>rgl</code> package for this).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plotIndiv</span>(MyResult.pca2,
          <span class="dt">group =</span> liver.toxicity<span class="op">$</span>treatment<span class="op">$</span>Dose.Group, <span class="dt">style=</span><span class="st">&quot;3d&quot;</span>,
          <span class="dt">legend =</span> <span class="ot">TRUE</span>, <span class="dt">title =</span> <span class="st">&#39;Liver toxicity: genes, PCA comp 1 - 2 - 3&#39;</span>)</code></pre></div>
</div>
</div>
<div id="sPCA" class="section level2">
<h2><span class="header-section-number">3.7</span> Variable selection with sparse PCA</h2>
<div id="biological-question-1" class="section level3">
<h3><span class="header-section-number">3.7.1</span> Biological question</h3>
<p><span style="color:blue"> <em>I would like to apply PCA but also be able to identify the key variables that contribute to the explanation of most variance in the data set</em> </span></p>
<p>Variable selection can be performed using the sparse version of PCA implemented in <code>spca</code> <span class="citation">(Shen and Huang <a href="#ref-She08">2008</a>)</span>. The user needs to provide the number of variables to select on each PC. Here for example we ask to select the top 15 genes contributing to the definition of PC1, the top 10 genes contributing to PC2 and the top 5 genes for PC3 (<code>keepX=c(15,10,5)</code>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">MyResult.spca &lt;-<span class="st"> </span><span class="kw">spca</span>(X, <span class="dt">ncomp =</span> <span class="dv">3</span>, <span class="dt">keepX =</span> <span class="kw">c</span>(<span class="dv">15</span>,<span class="dv">10</span>,<span class="dv">5</span>))                 <span class="co"># 1 Run the method</span>
<span class="kw">plotIndiv</span>(MyResult.spca, <span class="dt">group =</span> liver.toxicity<span class="op">$</span>treatment<span class="op">$</span>Dose.Group,   <span class="co"># 2 Plot the samples</span>
          <span class="dt">pch =</span> <span class="kw">as.factor</span>(liver.toxicity<span class="op">$</span>treatment<span class="op">$</span>Time.Group),
          <span class="dt">legend =</span> <span class="ot">TRUE</span>, <span class="dt">title =</span> <span class="st">&#39;Liver toxicity: genes, sPCA comp 1 - 2&#39;</span>,
          <span class="dt">legend.title =</span> <span class="st">&#39;Dose&#39;</span>, <span class="dt">legend.title.pch =</span> <span class="st">&#39;Exposure&#39;</span>)</code></pre></div>
<p><img src="Figures/unnamed-chunk-10-1.png" width="50%" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plotVar</span>(MyResult.spca, <span class="dt">cex =</span> <span class="dv">1</span>)                                        <span class="co"># 3 Plot the variables</span></code></pre></div>
<p><img src="Figures/unnamed-chunk-10-2.png" width="50%" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># cex is used to reduce the size of the labels on the plot</span></code></pre></div>
<p>Selected variables can be identified on each component with the <code>selectVar</code> function. Here the coefficient values are extracted, but there are other outputs, see <code>?selectVar</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">selectVar</span>(MyResult.spca, <span class="dt">comp =</span> <span class="dv">1</span>)<span class="op">$</span>value</code></pre></div>
<pre><code>##                value.var
## A_43_P20281  -0.39077443
## A_43_P16829  -0.38898291
## A_43_P21269  -0.37452039
## A_43_P20475  -0.32482960
## A_43_P20891  -0.31740002
## A_43_P14037  -0.27681845
## A_42_P751969 -0.26140533
## A_43_P15845  -0.22392912
## A_42_P814129 -0.18838954
## A_42_P680505 -0.18672610
## A_43_P21483  -0.16202222
## A_43_P21243  -0.13259471
## A_43_P22469  -0.12493156
## A_43_P23061  -0.12255308
## A_43_P11409  -0.09768656</code></pre>
<p>Those values correspond to the loading weights that are used to define each component. A large absolute value indicates the importance of the variable in this PC. Selected variables are ranked from the most important (top) to the least important.</p>
<p>We can complement this output with <code>plotLoadings</code>. We can see here that all coefficients are negative.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plotLoadings</span>(MyResult.spca)</code></pre></div>
<p><img src="Figures/unnamed-chunk-12-1.png" width="50%" style="display: block; margin: auto;" /></p>
<p>If we look at component two, we can see a mix of positive and negative weights (also see in the <code>plotVar</code>), those correspond to variables that oppose the low and high doses (see from the `plotIndiv):</p>
<p><img src="Figures/unnamed-chunk-13-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="tuning-parameters" class="section level2">
<h2><span class="header-section-number">3.8</span> Tuning parameters</h2>
<p>For this set of methods, two parameters need to be chosen:</p>
<ul>
<li>The number of components to retain,</li>
<li>The number of variables to select on each component for sparse PCA.</li>
</ul>
<p>The function <code>tune.pca</code> calculates the percentage of variance explained for each component, up to the minimum between the number of rows, or column in the data set. The `optimal’ number of components can be identified if an elbow appears on the screeplot. In the example below the cut-off is not very clear, we could choose 2 components.</p>
<p><img src="Figures/unnamed-chunk-14-1.png" width="50%" style="display: block; margin: auto;" /></p>
<p>Regarding the number of variables to select in sparse PCA, there is not clear criterion at this stage. As PCA is an exploration method, we prefer to set arbitrary thresholds that will pinpoint the key variables to focus on during the interpretation stage.</p>
</div>
<div id="additional-resources" class="section level2">
<h2><span class="header-section-number">3.9</span> Additional resources</h2>
<p>Additional examples are provided in <code>example(pca)</code> and in our case studies on our <a href="http://www.mixomics.org">website</a> in the <strong>Methods</strong> and <strong>Case studies</strong> sections.</p>
<p>Additional reading in <span class="citation">(Shen and Huang <a href="#ref-She08">2008</a>)</span>.</p>
</div>
<div id="faq" class="section level2">
<h2><span class="header-section-number">3.10</span> FAQ</h2>
<ul>
<li>Should I scale my data before running PCA? (<code>scale = TRUE</code> in <code>pca</code>)
<ul>
<li>Without scaling: a variable with high variance will solely drive the first principal component</li>
<li>With scaling: one noisy variable with low variability will be assigned the same variance as other meaningful variables</li>
</ul></li>
<li>Can I perform PCA with missing values?
<ul>
<li>NIPALS ( Non-linear Iterative PArtial Least Squares - implemented in mixOmics ) can impute missing values but must be built on many components. The proportion of NAs should not exceed 20% of total data.</li>
</ul></li>
<li>When should I apply a multilevel approach in PCA? (<code>multilevel</code> argument in <code>PCA</code>)
<ul>
<li>When the unique individuals are measured more than once (repeated measures)</li>
<li>When the individual variation is less than treatment or time variation. This means that samples from each unique individual will tend to cluster rather than the treatments.</li>
<li>When a multilevel vs no multilevel seems to visually make a difference on a PCA plot</li>
<li>More details in this <a href="http://mixomics.org/case-studies/multilevel-vac18/">case study</a></li>
</ul></li>
<li>When should I apply a CLR transformation in PCA? (<code>logratio = 'CLR'</code> argument in <code>PCA</code>)
<ul>
<li>When data are compositional, i.e. expressed as relative proportions. This is usually the case with microbiome studies as a result of pre-processing and normalisation, see more details <a href="http://mixomics.org/mixmc/">here</a> and in our case studies in the same tab.</li>
</ul></li>
</ul>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-Jol05">
<p>Jolliffe, Ian. 2005. <em>Principal Component Analysis</em>. Wiley Online Library.</p>
</div>
<div id="ref-She08">
<p>Shen, Haipeng, and Jianhua Z Huang. 2008. “Sparse Principal Component Analysis via Regularized Low Rank Matrix Approximation.” <em>Journal of Multivariate Analysis</em> 99 (6). Academic Press: 1015–34.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="start.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="plsda.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/03-PCA.Rmd",
"text": "Edit"
},
"download": ["Vignette-mixOmics.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
